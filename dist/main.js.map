{"version":3,"sources":["../src/main.ts"],"sourcesContent":["#!/usr/bin/env node\r\nimport { dirname, join } from 'node:path';\r\nimport { fileURLToPath } from 'node:url';\r\n\r\nimport { cac } from 'cac';\r\nimport fs from 'fs-extra';\r\n\r\nconst __dirname = dirname(fileURLToPath(import.meta.url));\r\nexport const commandList = ['init', 'build', 'sync', 'endpoint'] as const;\r\n\r\nasync function runModule(command: string, options: Record<string, any>) {\r\n  // Checks if the command is valid and exists in the command list.\r\n  // Also ensures that corresponding module file exists in (src/modules).\r\n\r\n  const modulePath = join(__dirname, 'modules', command, 'index.js');\r\n\r\n  if (!(await fs.pathExists(modulePath))) {\r\n    throw new Error(`Module for command \"${command}\" does not exist at path: ${modulePath}`);\r\n  }\r\n\r\n  const mod = await import(`file://${modulePath}`);\r\n  await mod.runCommand(options);\r\n}\r\n\r\n// Proceeds CLI initialization.\r\nconst cli = cac('contract');\r\n\r\n// Register commands dynamically.\r\nfor (const command of commandList) {\r\n  cli\r\n    .command(command, `Run ${command} command`)\r\n    .option('--ensure-sources, -u', 'Update source contract files')\r\n    .action((...args) => {\r\n      const options = args.pop();\r\n      return runModule(command, options);\r\n    });\r\n}\r\n\r\n// Additional help and version information.\r\ncli.help();\r\ncli.parse();\r\n"],"mappings":";;;AACA,SAAS,SAAS,YAAY;AAC9B,SAAS,qBAAqB;AAE9B,SAAS,WAAW;AACpB,OAAO,QAAQ;AAEf,IAAM,YAAY,QAAQ,cAAc,YAAY,GAAG,CAAC;AACjD,IAAM,cAAc,CAAC,QAAQ,SAAS,QAAQ,UAAU;AAE/D,eAAe,UAAU,SAAiB,SAA8B;AAItE,QAAM,aAAa,KAAK,WAAW,WAAW,SAAS,UAAU;AAEjE,MAAI,CAAE,MAAM,GAAG,WAAW,UAAU,GAAI;AACtC,UAAM,IAAI,MAAM,uBAAuB,OAAO,6BAA6B,UAAU,EAAE;AAAA,EACzF;AAEA,QAAM,MAAM,MAAM,OAAO,UAAU,UAAU;AAC7C,QAAM,IAAI,WAAW,OAAO;AAC9B;AAGA,IAAM,MAAM,IAAI,UAAU;AAG1B,WAAW,WAAW,aAAa;AACjC,MACG,QAAQ,SAAS,OAAO,OAAO,UAAU,EACzC,OAAO,wBAAwB,8BAA8B,EAC7D,OAAO,IAAI,SAAS;AACnB,UAAM,UAAU,KAAK,IAAI;AACzB,WAAO,UAAU,SAAS,OAAO;AAAA,EACnC,CAAC;AACL;AAGA,IAAI,KAAK;AACT,IAAI,MAAM;","names":[]}