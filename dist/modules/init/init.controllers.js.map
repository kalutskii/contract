{"version":3,"sources":["../../../src/modules/init/init.controllers.ts"],"sourcesContent":["import path from 'node:path';\r\n\r\nimport fs from 'fs-extra';\r\nimport prompts from 'prompts';\r\n\r\nimport { Contract } from '../../config/config.schemas.js';\r\n\r\nconst CONTRACT_DIR = path.join(process.cwd(), 'contract');\r\n\r\nexport async function ensureMissingSourceFiles(contracts: Contract[]): Promise<void> {\r\n  // Ensure that all source files for the contracts exist, creating them if necessary.\r\n\r\n  await Promise.all(\r\n    contracts.map(async (contract) => {\r\n      const filename = `contract.${contract.name}.source.ts`;\r\n      const destination = path.join(CONTRACT_DIR, 'source', filename);\r\n\r\n      const comment =\r\n        `// This file is pre-generated for contract: ${contract.name}\\n` +\r\n        (contract.emit ? '// !! Never re-export from index.ts ‚Äî use direct file exports.\\n' : '');\r\n\r\n      if (!(await fs.pathExists(destination))) {\r\n        await fs.writeFile(destination, comment);\r\n        console.log(`‚úÖ Created source file: ${filename}`);\r\n      }\r\n    })\r\n  );\r\n}\r\n\r\nasync function askForRewriteDirectory(): Promise<boolean> {\r\n  // Prompt the user to confirm if they want to rewrite the config file with default values.\r\n\r\n  const response = await prompts({\r\n    type: 'confirm',\r\n    name: 'rewrite',\r\n    message: 'The contract directory already exists. Do you want to rewrite it?',\r\n    initial: true,\r\n  });\r\n\r\n  return response.rewrite;\r\n}\r\n\r\nexport async function ensureContractDirectory(): Promise<void> {\r\n  // Rewrite the contract directory by removing it and creating a new one.\r\n\r\n  if (await fs.pathExists(CONTRACT_DIR)) {\r\n    if (await askForRewriteDirectory()) {\r\n      await fs.remove(CONTRACT_DIR);\r\n      await fs.ensureDir(CONTRACT_DIR);\r\n    } else return console.log('‚ùå Contract directory already exists, aborting initialization.');\r\n  }\r\n\r\n  await fs.ensureDir(CONTRACT_DIR);\r\n\r\n  console.log('üìÇ Contract directory ensured.');\r\n}\r\n\r\nexport async function createContractFolders(): Promise<void> {\r\n  // Initialize the contract directory structure with necessary subdirectories.\r\n\r\n  await fs.ensureDir(path.join(CONTRACT_DIR, 'source'));\r\n  await fs.ensureDir(path.join(CONTRACT_DIR, 'export'));\r\n  await fs.ensureDir(path.join(CONTRACT_DIR, 'synced'));\r\n\r\n  console.log('üìÇ Contract folders created.');\r\n}\r\n"],"mappings":";AAAA,OAAO,UAAU;AAEjB,OAAO,QAAQ;AACf,OAAO,aAAa;AAIpB,IAAM,eAAe,KAAK,KAAK,QAAQ,IAAI,GAAG,UAAU;AAExD,eAAsB,yBAAyB,WAAsC;AAGnF,QAAM,QAAQ;AAAA,IACZ,UAAU,IAAI,OAAO,aAAa;AAChC,YAAM,WAAW,YAAY,SAAS,IAAI;AAC1C,YAAM,cAAc,KAAK,KAAK,cAAc,UAAU,QAAQ;AAE9D,YAAM,UACJ,+CAA+C,SAAS,IAAI;AAAA,KAC3D,SAAS,OAAO,0EAAqE;AAExF,UAAI,CAAE,MAAM,GAAG,WAAW,WAAW,GAAI;AACvC,cAAM,GAAG,UAAU,aAAa,OAAO;AACvC,gBAAQ,IAAI,+BAA0B,QAAQ,EAAE;AAAA,MAClD;AAAA,IACF,CAAC;AAAA,EACH;AACF;AAEA,eAAe,yBAA2C;AAGxD,QAAM,WAAW,MAAM,QAAQ;AAAA,IAC7B,MAAM;AAAA,IACN,MAAM;AAAA,IACN,SAAS;AAAA,IACT,SAAS;AAAA,EACX,CAAC;AAED,SAAO,SAAS;AAClB;AAEA,eAAsB,0BAAyC;AAG7D,MAAI,MAAM,GAAG,WAAW,YAAY,GAAG;AACrC,QAAI,MAAM,uBAAuB,GAAG;AAClC,YAAM,GAAG,OAAO,YAAY;AAC5B,YAAM,GAAG,UAAU,YAAY;AAAA,IACjC,MAAO,QAAO,QAAQ,IAAI,oEAA+D;AAAA,EAC3F;AAEA,QAAM,GAAG,UAAU,YAAY;AAE/B,UAAQ,IAAI,uCAAgC;AAC9C;AAEA,eAAsB,wBAAuC;AAG3D,QAAM,GAAG,UAAU,KAAK,KAAK,cAAc,QAAQ,CAAC;AACpD,QAAM,GAAG,UAAU,KAAK,KAAK,cAAc,QAAQ,CAAC;AACpD,QAAM,GAAG,UAAU,KAAK,KAAK,cAAc,QAAQ,CAAC;AAEpD,UAAQ,IAAI,qCAA8B;AAC5C;","names":[]}